<nz-table
  #headerTable
  [nzData]="tasksData"
  [nzPageSize]="50"
  [nzBordered]="true"
  [nzShowSizeChanger]="true"
  [nzScroll]="{ y: '240px' }"
>
  <thead>
    <tr>
      <th rowspan="2">Nome</th>
      <th rowspan="2">Descrição</th>
      <th rowspan="2">Projeto</th>
      <th colspan="3">Datas</th>
      <th rowspan="2">Estatus</th>
      <th rowspan="2">Ações</th>
    </tr>
    <tr>
      <th rowspan="1">Criação</th>
      <th rowspan="1">Início</th>
      <th rowspan="1">Final</th>
    </tr>
  </thead>
  <tbody>
    @for (data of tasksData; track data.id) {
    <tr>
      <td>{{ data.nome }}</td>
      <td>{{ data.descricao }}</td>
      <td>{{ data.projeto.nome }}</td>
      <td>{{ dateFormater(data.dataCriacao) }}</td>
      <td>{{ dateFormater(data.dataInicio) }}</td>
      <td>{{ dateFormater(data.dataFim) }}</td>
      @if(data.status === 'EM_ANDAMENTO') {
      <td>EM ANDAMENTO</td>
      }@else {
      <td>{{ data.status }}</td>
      }
      <td id="botoes">
        <button
          nz-button
          nzType="primary"
          nzSize="large"
          nzShape="circle"
          (click)="showModal(data)"
        >
          <nz-icon nzType="edit" />
        </button>
        <button
          nz-button
          nzType="primary"
          nzSize="large"
          nzShape="circle"
          nzDanger
          [nzLoading]="loadingTasks[data.id]"
          nz-popconfirm
          nzPopconfirmTitle="Deseja realmente excluir esta atividade?"
          (nzOnConfirm)="deleteTask(data.id)"
        >
          <nz-icon nzType="delete" />
        </button>
      </td>
    </tr>
    }
  </tbody></nz-table
>

<nz-modal
  [(nzVisible)]="isVisible"
  [nzTitle]="modalTitle"
  [nzContent]="modalContent"
  [nzFooter]="null"
  (nzOnCancel)="handleCancel()"
>
  <ng-template #modalTitle>Editar Atividade</ng-template>

  <ng-template #modalContent>
    <app-edit-task
      (closeModal)="handleCancel()"
      [taskEdit]="selectedTask"
    />
  </ng-template>
</nz-modal>
